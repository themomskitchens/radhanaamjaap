<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Radha Naam Jaap</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Cinzel:wght@600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:Poppins;
  background:#050008;
  color:#fff;
  overflow:hidden;
}
.screen{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
}
.hidden{display:none}

.card{
  width:90%;
  max-width:420px;
  background:rgba(255,255,255,0.07);
  backdrop-filter:blur(20px);
  border-radius:26px;
  padding:30px;
  text-align:center;
  box-shadow:0 0 50px rgba(255,0,200,.35);
}

h1,h2{
  font-family:Cinzel;
  margin-bottom:10px;
}

input,button{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  margin-top:15px;
  font-size:16px;
}
button{
  background:linear-gradient(135deg,#ffd700,#ff7a00);
  font-weight:600;
  cursor:pointer;
}

#overlay{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:64px;
  font-family:Cinzel;
  pointer-events:none;
  opacity:0;
  text-shadow:0 0 30px #ffb3ff,0 0 60px #ff33ff;
}
.overlay-anim{
  animation:pop .4s ease forwards;
}
@keyframes pop{
  0%{opacity:0;transform:scale(.4)}
  40%{opacity:1;transform:scale(1.4)}
  100%{opacity:0;transform:scale(1)}
}

.stats{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:10px;
  margin-top:20px;
}
.stat{
  background:rgba(0,0,0,.4);
  border-radius:14px;
  padding:12px;
}
.stat span{
  display:block;
  font-size:22px;
  font-weight:600;
  margin-top:5px;
}

</style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="loginScreen" class="screen">
  <div class="card">
    <h1>üôè Radha Naam</h1>
    <p>Digital Bhakti Anubhav</p>
    <input id="nameInput" placeholder="Bhakt ka naam">
    <button onclick="login()">Pravesh</button>
  </div>
</div>

<!-- JAAP SCREEN -->
<div id="jaapScreen" class="screen hidden">
  <div class="card">
    <h2 id="welcome"></h2>
    <button id="startBtn">Start Jaap</button>

    <div class="stats">
      <div class="stat">Today<span id="today">0</span></div>
      <div class="stat">Yesterday<span id="yesterday">0</span></div>
      <div class="stat">Week<span id="week">0</span></div>
      <div class="stat">Month<span id="month">0</span></div>
      <div class="stat" style="grid-column:span 2">
        Total<span id="total">0</span>
      </div>
    </div>
  </div>
</div>

<div id="overlay">Radha</div>

<audio id="bell" src="https://actions.google.com/sounds/v1/bells/temple_bell.ogg"></audio>

<script>
/* LOGIN */
function login(){
  const n=nameInput.value.trim();
  if(!n) return;
  localStorage.setItem("bhakt",n);
  loginScreen.classList.add("hidden");
  jaapScreen.classList.remove("hidden");
  welcome.innerText="Radha Naam ‚Äì "+n;
  loadStats();
}

/* DATE HELPERS */
const todayStr=()=>new Date().toISOString().slice(0,10);
const getWeekKey=()=>{
  const d=new Date();
  const first=new Date(d.setDate(d.getDate()-d.getDay()));
  return first.toISOString().slice(0,10);
}
const monthKey=()=>new Date().toISOString().slice(0,7);

/* DATA */
let data=JSON.parse(localStorage.getItem("jaapData")||"{}");
let lastHit=0;

function addJaap(){
  const now=Date.now();
  if(now-lastHit<600) return; // duplicate protection
  lastHit=now;

  const t=todayStr();
  data[t]=(data[t]||0)+1;
  localStorage.setItem("jaapData",JSON.stringify(data));

  showOverlay();
  if(data[t]%108===0) bell.play();
  loadStats();
}

function loadStats(){
  const t=todayStr();
  const y=new Date(Date.now()-86400000).toISOString().slice(0,10);
  const wk=getWeekKey();
  const mk=monthKey();

  let total=0,week=0,month=0;

  for(let d in data){
    total+=data[d];
    if(d>=wk) week+=data[d];
    if(d.startsWith(mk)) month+=data[d];
  }

  today.innerText=data[t]||0;
  yesterday.innerText=data[y]||0;
  weekEl.innerText=week;
  monthEl.innerText=month;
  totalEl.innerText=total;
}

const weekEl=document.getElementById("week");
const monthEl=document.getElementById("month");
const totalEl=document.getElementById("total");

/* OVERLAY */
function showOverlay(){
  overlay.classList.remove("overlay-anim");
  void overlay.offsetWidth;
  overlay.classList.add("overlay-anim");
}

/* SPEECH */
let rec,listening=false;
startBtn.onclick=()=>{
  if(listening){rec.stop();startBtn.innerText="Start Jaap";listening=false;return;}
  const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
  rec=new SR();
  rec.lang="en-IN";
  rec.continuous=true;
  rec.interimResults=true;
  rec.onresult=e=>{
    const txt=e.results[e.results.length-1][0].transcript.toLowerCase();
    if(txt.includes("radha")) addJaap();
  };
  rec.start();
  startBtn.innerText="Stop Jaap";
  listening=true;
};

/* AUTO LOGIN */
if(localStorage.getItem("bhakt")) login();
</script>
</body>
</html>
